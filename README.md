# OilMate - تطبيق دليل زيت السيارات الشامل

تطبيق Flutter شامل لتوصيات زيت السيارات مع قاعدة بيانات Supabase وبحث VIN متقدم.

## 🌟 المميزات الجديدة

### 🗄️ قاعدة بيانات Supabase الشاملة
- **قاعدة بيانات حقيقية**: تخزين شامل لمعلومات السيارات والزيوت
- **بيانات محدثة**: معلومات دقيقة لسيارات الولايات المتحدة والشرق الأوسط والصين
- **دعم المناطق المختلفة**: تصنيف السيارات حسب المنطقة الجغرافية

### 🔍 بحث VIN متطور
- **تكامل NHTSA API**: فك تشفير VIN من مصادر رسمية
- **تخزين ذكي**: حفظ النتائج في قاعدة البيانات للوصول السريع
- **اكتشاف المنطقة**: تحديد منطقة السيارة تلقائياً من رقم VIN

### 🛠️ معلومات المحرك التفصيلية
- **مواصفات شاملة**: قوة المحرك، عزم الدوران، نوع الوقود
- **معلومات تقنية**: نسبة الضغط، نظام الصمامات، التيربو/السوبرتشارج
- **توافق الزيوت**: أنواع الزيت المتوافقة مع كل محرك

### 🛢️ توصيات الزيت المتقدمة
- **كميات دقيقة**: كمية الزيت مع وبدون الفلتر
- **فترات الصيانة**: مواعيد تغيير الزيت المحددة
- **أرقام القطع**: أرقام فلاتر الزيت الأصلية
- **علامات بديلة**: خيارات متعددة للعلامات التجارية

### 📱 واجهة مستخدم محسنة
- **تصميم متقدم**: واجهة عصرية مع Material Design 3
- **دعم العربية**: واجهة كاملة باللغة العربية مع دعم RTL
- **تنقل سهل**: علامات تبويب وشاشات منظمة
- **رسوم متحركة**: انتقالات سلسة وتأثيرات بصرية

### 📊 إدارة الصيانة
- **سجلات شاملة**: تتبع جميع أعمال الصيانة
- **تكاليف مفصلة**: تسجيل التكاليف بعملات مختلفة
- **تواريخ الخدمة**: تتبع مواعيد الصيانة والكيلومترات
- **ملاحظات مخصصة**: إضافة ملاحظات لكل عملية صيانة

### 🔧 تتبع التعديلات
- **حالة التعديل**: تسجيل ما إذا كانت السيارة معدلة
- **وصف التعديلات**: تفاصيل التعديلات المثبتة
- **تأثير على التوصيات**: تعديل توصيات الزيت حسب التعديلات

## 🏗️ البنية التقنية الجديدة

### 📁 هيكل المشروع المحدث

```
lib/
├── config/
│   └── supabase_config.dart      # إعدادات Supabase
├── models/
│   ├── vehicle_model.dart        # نموذج بيانات السيارة
│   ├── oil_specification.dart    # مواصفات الزيت
│   ├── engine_specification.dart # مواصفات المحرك
│   └── maintenance_record.dart   # سجلات الصيانة
├── services/
│   ├── car_database_service.dart # خدمة قاعدة البيانات الشاملة
│   └── vin_service.dart          # خدمة VIN الأساسية (محتفظ بها للتوافق)
├── screens/
│   ├── splash_screen.dart        # شاشة البحث الرئيسية
│   ├── vin_result_screen.dart    # نتائج البحث المحدثة
│   ├── detailed_vehicle_screen.dart # معلومات السيارة التفصيلية
│   ├── maintenance_screen.dart   # إضافة سجلات الصيانة
│   └── oil_products_screen.dart  # عرض منتجات الزيت
└── main.dart                     # نقطة البداية مع تهيئة Supabase

database/
├── schema.sql                    # مخطط قاعدة البيانات الكامل
└── seed_data.sql                 # بيانات أولية شاملة
```

### 🗃️ قاعدة البيانات Supabase

#### الجداول الرئيسية:

1. **vehicles** - معلومات السيارات الأساسية
2. **engine_specifications** - مواصفات المحركات التفصيلية  
3. **oil_specifications** - توصيات الزيت المتخصصة
4. **maintenance_records** - سجلات الصيانة
5. **car_models** - قاعدة بيانات نماذج السيارات
6. **oil_products** - منتجات الزيت التجارية
7. **service_centers** - مراكز الخدمة المعتمدة

#### مميزات قاعدة البيانات:
- **Row Level Security (RLS)** للأمان
- **Triggers** للتحديث التلقائي
- **Indexes** للأداء المحسن
- **JSON Support** للبيانات المرنة
- **UUID** للمعرفات الفريدة

## 🚀 التشغيل والإعداد

### متطلبات النظام
- Flutter SDK 3.22.0+
- Dart SDK 3.8.1+
- حساب Supabase (للإنتاج)

### خطوات التشغيل

1. **استنساخ المشروع:**
```bash
git clone https://github.com/alimuthana222/caroil-flutter.git
cd caroil-flutter
```

2. **تثبيت التبعيات:**
```bash
flutter pub get
```

3. **إعداد Supabase:**
   - إنشاء مشروع جديد في [Supabase](https://supabase.com)
   - تشغيل ملف `database/schema.sql` في SQL Editor
   - تشغيل ملف `database/seed_data.sql` لإدراج البيانات الأولية
   - تحديث `lib/config/supabase_config.dart` بالمعلومات الصحيحة:

```dart
static const String supabaseUrl = 'YOUR_SUPABASE_URL';
static const String supabaseAnonKey = 'YOUR_SUPABASE_ANON_KEY';
```

4. **إنتاج النماذج:**
```bash
dart run build_runner build
```

5. **تشغيل التطبيق:**
```bash
flutter run
```

## 📱 الشاشات والوظائف

### 1. شاشة البحث الرئيسية
- إدخال رقم VIN مع التحقق التلقائي
- دعم 17 خانة مع استبعاد الأحرف المحظورة (I, O, Q)
- واجهة عربية مع تدرجات لونية جذابة

### 2. شاشة نتائج البحث
- عرض معلومات السيارة الأساسية
- توصيات الزيت المفصلة
- معلومات المحرك التقنية
- أزرار للانتقال للتفاصيل الكاملة

### 3. شاشة التفاصيل الشاملة
- **علامة تبويب المعلومات:** بيانات السيارة وحالة التعديل
- **علامة تبويب المحرك:** مواصفات تقنية مفصلة
- **علامة تبويب الزيت:** توصيات شاملة ومنتجات متاحة
- **علامة تبويب الصيانة:** سجلات الصيانة التاريخية

### 4. شاشة إضافة الصيانة
- نموذج شامل لتسجيل أعمال الصيانة
- اختيار نوع الخدمة من قائمة محددة مسبقاً
- تسجيل تفاصيل الزيت والفلتر المستخدم
- حساب التكاليف بعملات مختلفة

### 5. شاشة منتجات الزيت
- عرض المنتجات المتوافقة مع السيارة
- تصفية حسب نوع الزيت (صناعي، نصف صناعي، تقليدي)
- معلومات الأسعار والتوفر حسب المنطقة
- مميزات ومواصفات كل منتج

## 🌍 الدعم الإقليمي

### المناطق المدعومة:
- **الولايات المتحدة وكندا** - قاعدة بيانات NHTSA
- **الشرق الأوسط** - السعودية، الإمارات، الكويت، قطر
- **الصين** - السيارات المحلية والمستوردة
- **أوروبا** - المعايير الأوروبية
- **آسيا** - اليابان، كوريا الجنوبية

### العملات المدعومة:
- USD (دولار أمريكي)
- SAR (ريال سعودي)  
- AED (درهم إماراتي)
- EUR (يورو)
- CNY (يوان صيني)

## 🔧 التطوير والتخصيص

### إضافة نماذج سيارات جديدة:
1. إدراج البيانات في جدول `car_models`
2. إضافة مواصفات المحرك في `engine_specifications`
3. تحديد توصيات الزيت في `oil_specifications`

### إضافة منتجات زيت جديدة:
1. إدراج في جدول `oil_products`
2. تحديد المناطق المتاحة
3. ربط بالسيارات المتوافقة

### تخصيص التوصيات:
- تعديل دالة `_getOilSpecsForVehicle` في `car_database_service.dart`
- إضافة شروط جديدة للماركات والموديلات
- تحديث قاعدة البيانات بالمعلومات الجديدة

## 🧪 الاختبار

### تشغيل الاختبارات:
```bash
flutter test
```

### اختبارات قاعدة البيانات:
```bash
flutter test test/database_test.dart
```

### اختبارات الخدمات:
```bash
flutter test test/services_test.dart
```

## 📦 البناء للإنتاج

### Android:
```bash
flutter build apk --release
```

### iOS:
```bash
flutter build ios --release
```

### Web:
```bash
flutter build web --release
```

## 🔒 الأمان والخصوصية

- **Row Level Security** في Supabase
- **تشفير البيانات** أثناء النقل والتخزين
- **مصادقة اختيارية** للمستخدمين
- **حماية API Keys** في متغيرات البيئة

## 🐛 المشاكل المعروفة والحلول

### 1. خطأ الاتصال بـ Supabase:
- التأكد من صحة URL و API Key
- فحص اتصال الإنترنت
- التحقق من إعدادات RLS

### 2. بطء في تحميل البيانات:
- فحص الـ Indexes في قاعدة البيانات
- تحسين الاستعلامات
- استخدام التخزين المؤقت

### 3. مشاكل في عرض النص العربي:
- التأكد من تضمين الخطوط المناسبة
- فحص إعدادات RTL
- تحديث Flutter إلى أحدث إصدار

## 🤝 المساهمة

نرحب بالمساهمات! الرجاء:

1. Fork المشروع
2. إنشاء branch جديد للميزة المطلوبة
3. Commit التغييرات مع رسائل واضحة
4. Push إلى الـ branch
5. إنشاء Pull Request

## 📄 الترخيص

هذا المشروع مرخص تحت رخصة MIT. راجع ملف `LICENSE` للتفاصيل.

## 📞 الدعم والتواصل

- **Issues**: [GitHub Issues](https://github.com/alimuthana222/caroil-flutter/issues)
- **Discussions**: [GitHub Discussions](https://github.com/alimuthana222/caroil-flutter/discussions)

---

**OilMate** - دليلك الشامل لزيت السيارات 🛢️🚗